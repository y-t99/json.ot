# json.ot
The `json0` typescript version

## Notion

### Snapshot

Snapshots represents the data structure of a document, which can be understood as a string in `Text OT Type`, or can be understood as JSON in `JSON OT Type`. Snapshots are generated by applying a series of operations.

### Operation

Operations represent modifications to a document, similar to the diff between two commits in Git operations. An operation includes multiple actions. An action is an atomic operation on a document.

## Text OT Type

### Action

Operation                              | Description
---------------------------------------|-------------------------------------
`{n: 'SI', p: number, i: string}`      | inserts the string `i` at offset `p` into the string 
`{n: 'SD', p: number, d: string}`      | delete the string `d` at offset `p` from the string 

### Method

#### apply(snapshot, operation)

Applying an operation to a snapshot:

```typescript

const operation: ITOTAction[] = [
  {
    n: TOTActionName.StringInsert,
    p: 0,
    i: 'hello',
  },
];
const result = tot.apply(' world', operation);
expect(result).toEqual('hello world');
```

#### compose(operationA, operationB)

Merge operations which have a linear relationship:

```typescript
const snapshot = 'AD';
const opeartionA: ITOTAction[] = [{
  n: TOTActionName.StringInsert,
  p: 1,
  i: 'B',
}];
const operationB: ITOTAction[] = [{
  n: TOTActionName.StringInsert,
  p: 2,
  i: 'C',
}];
const snapshotA = tot.apply(tot.apply(snapshot, opeartionA), operationB);
const snapshotB = tot.apply(snapshot, tot.compose(opeartionA, operationB));
expect(snapshotA === snapshotB).toBeTruthy();
```

